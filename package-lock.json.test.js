import pkgLock from './package-lock.json' with { type: 'json' }

describe('package-lock.json', () => {
  const { packages } = pkgLock

  describe('Dependabot updates', () => {
    it("should not hoist 'optionalDependencies' to 'dependencies'", () => {
      // @ts-expect-error - Allow missing `dependencies` when none installed
      const { dependencies = {}, optionalDependencies = {} } = packages['']

      // List package names for comparison
      const packageNames = Object.keys(dependencies)
      const packageNamesOptional = Object.keys(optionalDependencies)

      // Check no optional dependencies are hoisted
      for (const name of packageNamesOptional) {
        expect(packageNames).not.toContain(name)
      }
    })
  })
})
