{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/skip-link/macro.njk" import govukSkipLink %}
{% from "govuk/components/input/macro.njk" import govukInput %}
<div>
  {% if params.pageTitle.text %}
    <h2 class="govuk-heading-l">
      {{ params.pageTitle.text }}
    </h2>
  {% endif %}

  {# Render sections if available #}
  {% if params.sections | length %}
    <div id="sections-preview">
      {% for section in params.sections %}
        {% if section.pages.length > 0 %}
          <h4 class="govuk-heading-m {{ section.classes }}" data-preview-section-id="{{ section.name }}">{{ section.title }}</h4>
          <dl class="govuk-summary-list govuk-!-margin-bottom-9">
            {% for page in section.pages %}
            <div class="govuk-summary-list__row">
              <dt class="govuk-summary-list__key">{{ page.title }}</dt>
              <dd class="govuk-summary-list__value">Answer goes here</dd>
              <dd class="govuk-summary-list__actions">
                <a class="govuk-link govuk-link--disabled" href="#" aria-disabled="true">
                  Change<span class="govuk-visually-hidden"> {{ page.title }}</span>
                </a>
              </dd>
            </div>
            {% endfor %}
          </dl>
        {% else %}
          <h4 class="govuk-heading-m {{ section.classes }}" data-preview-section-id="{{ section.name }}">{{ section.title }}</h4>
          <p class="govuk-hint">No pages in this section</p>
        {% endif %}
      {% endfor %}

      {% if params.unassignedPages | length %}
        <dl class="govuk-summary-list">
          {% for page in params.unassignedPages %}
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">{{ page.title }}</dt>
            <dd class="govuk-summary-list__value">Answer goes here</dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link govuk-link--disabled" href="#" aria-disabled="true">
                Change<span class="govuk-visually-hidden"> {{ page.title }}</span>
              </a>
            </dd>
          </div>
          {% endfor %}
        </dl>
      {% endif %}
    </div>
  {% else %}
    {# Fallback to flat component rows when no sections #}
    {{ govukSummaryList(params.componentRows) }}
  {% endif %}

  {% if params.showConfirmationEmail %}
    <div class="govuk-!-margin-top-6">
      {{ govukInput({
        id: "userConfirmationEmailAddress",
        name: "userConfirmationEmailAddress",
        label: {
          text: "Confirmation email (optional)",
          classes: "govuk-label--m"
        },
        hint: {
          text: "Enter your email address to receive a confirmation email and a copy of your answers"
        }
      }) }}
    </div>
  {% endif %}
  {% for component in params.components %}
    {% if loop.index0 === 0 %}
      {% set model = component.model %}
      <div class="border-left-container govuk-!-margin-top-6">
        {%- include 'preview-components/markdown.njk' -%}
      </div>
    {% endif %}
  {% endfor %}
  <div class="govuk-button-group govuk-!-margin-top-6">
    {{ govukSkipLink({
      text: "Skip to page settings",
      href: "#page-settings",
      classes: "govuk-!-margin-right-4"
    }) }}
    {{ govukButton({
      text: params.buttonText,
      disabled: true
    }) }}
  </div>
</div>
