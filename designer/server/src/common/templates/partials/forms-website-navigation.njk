{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}
{% from "service-header/macro.njk" import appServiceHeader %}
{% from "tag-env/macro.njk" import appTagEnv %}

{%- set productName %}
  Forms Designer {{ appTagEnv({ env: config.cdpEnvironment }) }}
{% endset -%}

{%- set accountLinkUrl = "/auth/account" if (isAuthenticated and config.featureFlagUseEntitlementApi) else "/library" -%}

{%- set adminNavigation = [] -%}
{%- if isAuthenticated and isAdmin -%}
  {%- set adminNavigation = [
    {
      text: "Manage users",
      url: "/manage/users"
    }
  ] -%}
{%- endif -%}

{{ appServiceHeader({
  organisationName: "Defra",
  productName: productName | safe | trim,
  navigationItems: navigation if (isAuthenticated and (isFormsUser or isAdmin)),
  adminNavigation: adminNavigation if (isAuthenticated and isAdmin),
  accountName: authedUser.displayName if isAuthenticated,
  accountLink: accountLinkUrl,
  signOutLink: "/auth/sign-out",
  homepageLink: "/"
}) }}

{%- set navigationClasses = "govuk-service-navigation--green" if displayHomeNav else "" -%}
{% if isGuest %}
{{ govukServiceNavigation({
  classes: navigationClasses,
  navigation: pageNavigation
}) }}
{% endif %}
