{% extends 'layouts/page.njk' %}

{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/tag/macro.njk" import govukTag %}

{% block content %}
  {{ appHeading({
    text: pageTitle
  }) }}

  {% call appPageBody() %}
    {% set formRows = [] %}

    {% for formItem in formItems %}
      {% set formName %}
        <a href="{{ formItem.href }}" class="govuk-link govuk-link--no-visited-state">
          {{ formItem.title }}
        </a>
      {% endset %}

      {% set formUpdated %}
        Updated </span>{{ formItem.updated.date }}
      {% endset %}

      {% set formNameUpdated %}
        {{ formName | safe }}
        <p class="govuk-!-margin-top-2 govuk-!-margin-bottom-1">
          {{ formUpdated | safe }}
        </p>
      {% endset %}

      {% set formStatus %}
        {% set tagDraft = govukTag({ text: "Draft", classes: "govuk-tag--orange govuk-!-margin-bottom-1" }) %}
        {% set tagLive = govukTag({ text: "Live", classes: "govuk-tag--green govuk-!-margin-top-1" }) %}

        {% switch formItem.status %}
          {% case "draft" %}
            {{ tagDraft }}
          {% case "draft-live" %}
            {{ tagDraft }} {{ tagLive }}
          {% case "live" %}
            {{ tagLive }}
        {% endswitch %}
      {% endset %}

      {% set formRows = (formRows.push([
        {
          html: formName
        },
        {
          html: formUpdated
        },
        {
          html: formStatus
        }
      ]), formRows) %}
    {% endfor %}

    {{ govukTable({
      head: [
        {
          text: "Name",
          classes: "govuk-!-width-one-half"
        },
        {
          text: "Last updated"
        },
        {
          text: "Status"
        }
      ],
      rows: formRows
    }) }}
  {% endcall %}
{% endblock %}
